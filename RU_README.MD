# Телеграм бот для загрузки фотографий космоса

Данный проект содержит несколько скриптов для скачивания изображений с Astronomy Picture of the Day (APOD) NASA, Earth Polychromatic Imaging Camera (EPIC) NASA и последних запусков SpaceX. Скачанные изображения можно опубликовать в канале Telegram по требованию или с определенной периодичностью. Утилитарный скрипт `common_scripts.py` содержит вспомогательные функции для создания папок, получения расширения файлов и форматирования даты epic NASA.

## Установка

1. Получите свой ключ API NАSА на [https://api.nasa.gov/](https://api.nasa.gov/).
2. Получите свой ключ API Telegram, создав нового бота с помощью [BotFather](https://core.telegram.org/bots#botfather).
3. Склонируйте репозиторий и создайте файл `.env` в корневой директории проекта со следующим содержимым:

`NASA_API_TOKEN=your_nasa_api_token`\
`TELEGRAM_BOT_TOKEN=your_telegram_bot_token`\
`FREQUENSY_OF_PUBLICATION=hours`


4. Python3 должен быть установлен на вашем компьютере. Затем используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:

`pip install -r requirements.txt`


## Использование

### 1. Скрипт `fetch_nasa_apod_images.py`

Данный скрипт скачивает изображения с Astronomy Picture of the Day (APOD) NASA и сохраняет их в локальную папку `'images'`. Если такой папки нет, то создает ее.

#### Функции 

- `fetch_nasa_apod(token, count_images)`: Основная функция скрипта, принимающая следующие параметры:
  - `token`: Ваш ключ API NASA.
  - `count`: Количество изображений для загрузки (по умолчанию: 3). Скрипт загружает случайную выборку изображений, если количество не указано.

#### Запуск

Скрипт можно запустить из консоли с помощью команды:

`python fetch_nasa_apod_images.py [--count COUNT]`


#### Аргументы

- `--count COUNT:` (необязательный) Количество изображений для загрузки. По умолчанию загружаются 3 изображения.

Данный скрипт импортирует и использует функции из отдельных скриптов следующим образом:

- Для сохранения загруженных изображений он использует функцию `download_image` из скрипта `common_scripts.py`.
- Для получения расширения файла он использует функцию `get_extension` из скрипта `common_scripts.py`.


### 2. Скрипт `fetch_nasa_epic_images.py`

Данный скрипт скачивает изображения с Earth Polychromatic Imaging Camera (EPIC) NASA и сохраняет их в локальную папку `'images'`. Если такой папки нет, то создает ее.

#### Функции

- `fetch_nasa_epic(token)`: Основная функция скрипта, принимающая следующие параметры:
  - `token`: Ваш ключ API NASA.

#### Запуск

Скрипт можно запустить из консоли с помощью команды:

`python fetch_nasa_epic_images.py`

#### Аргументы

Данный скрипт не принимает аргументов командной строки.

Данный скрипт импортирует и использует функции из отдельных скриптов следующим образом:

- Для сохранения загруженных изображений он использует функцию `download_image` из скрипта `common_scripts.py`.
- Для получения даты из NASA EPIC `get_date_from_epic` из скрипта `common_scripts.py`.


### 3. Скрипт `fetch_spacex_images.py`

Данный скрипт скачивает изображения, связанные с последним запуском SpaceX или указанным запуском, и сохраняет их в локальную папку `'images'`. Если такой папки нет, то создает ее.

#### Функции

- `fetch_spacex_images(launch_id=None)`: Основная функция скрипта, принимающая следующие параметры:
  - `launch_id`: (необязательный) Идентификатор запуска SpaceX, для которого необходимо загрузить изображения. Если не указан, будут загружены изображения последнего запуска.

#### Запуск

Скрипт можно запустить из консоли с помощью команды:

`python fetch_spacex_images.py [--id LAUNCH_ID]`

#### Аргументы

- `--id LAUNCH_ID`: (необязательный) Идентификатор запуска SpaceX, для которого необходимо загрузить изображения. Если не указан, будут загружены изображения последнего запуска.

Данный скрипт импортирует и использует функции из отдельных скриптов следующим образом:

- Для сохранения загруженных изображений он использует функцию `download_image` из скрипта `common_scripts.py`.


### 4. Скрипт `fetch_all_images.py`

Данный скрипт объединяет функциональность скриптов `fetch_spacex_images.py`, `fetch_nasa_apod_images.py` и `fetch_nasa_epic_images.py`. Он загружает изображения от SpaceX, NASA APOD и NASA EPIC и сохраняет их в локальную папку `'images'`. Если такой папки нет, то создает ее.

#### Запуск

Скрипт можно запустить из консоли с помощью команды:

`python fetch_all_images.py [--id LAUNCH_ID] [--count COUNT]`

#### Аргументы
- `--id LAUNCH_ID`: (необязательный) Идентификатор запуска SpaceX, для которого необходимо загрузить изображения. Если не указан, будут загружены изображения последнего запуска.
- `--count COUNT`: (необязательный) Количество изображений NASA APOD для загрузки. Если не указано, будет использовано значение по умолчанию - 3.

Данный скрипт импортирует и использует функции из отдельных скриптов следующим образом:

- `fetch_spacex_images(args.id)` из скрипта `fetch_spacex_images.py`.
- `fetch_nasa_apod(token, args.count)` из скрипта `fetch_nasa_apod_images.py`.
- `fetch_nasa_epic(token)` из скрипта `fetch_nasa_epic_images.py`.


### 5. Скрипт `telegram_bot.py`

Этот скрипт публикует одно изображение в указанном канале Telegram. Изображение может быть выбрано случайным образом из папки или указано по имени.

#### Функции

- `publish_image(token, chat_id, folder_name, image_name)`: Основная функция скрипта, принимающая следующие параметры:
  - `token`: Ваш токен API Telegram.
  - `chat_id`: Уникальный идентификатор канала Telegram, в который будет опубликовано изображение.
  - `folder_name`: (необязательный) Имя папки, содержащей изображения. Если не указано, по умолчанию будет использовано `images`.
  - `image_name`: (необязательный) Имя изображения для публикации. Если не указано, будет опубликовано случайное изображение из папки.

#### Запуск

Скрипт можно запустить из консоли с помощью команды:

`python telegram_bot.py [--folder_name FOLDER_NAME] [--image_name IMAGE_NAME]`

#### Аргументы

- `--folder_name FOLDER_NAME`: (необязательный) Имя папки, содержащей изображения. Если не указано, будет использоваться имя папки по умолчанию - 'images'.
- `--image_name IMAGE_NAME`: (необязательный) Имя изображения для публикации. Если не указано, будет опубликовано случайное изображение из папки.


### 6. Скрипт `autopublish_bot.py`

Этот скрипт публикует изображения в указанном канале Telegram с определенными интервалами. Изображения выбираются случайным образом из папки и публикуются с указанной частотой.

#### Функции

- `autopublish_images(token, chat_id, folder_name, frequensy_of_publication)`: Основная функция скрипта, принимающая следующие параметры:
  - `token`: Ваш токен API Telegram.
  - `chat_id`: Уникальный идентификатор канала Telegram, в который будут опубликованы изображения.
  - `folder_name`: Имя папки, содержащей изображения. По умолчанию используется `images`.
  - `frequensy_of_publication`: Частота публикации в часах. По умолчанию один раз в 4 часа. Частоту можно поменять в `.env` файле.

#### Запуск

Скрипт можно запустить из консоли с помощью следующей команды:

`python autopublish_bot.py [--folder_name FOLDER_NAME]`

#### Аргументы

- `--folder_name` Имя папки, содержащей изображения. По умолчанию используется `images`.

### 7. Скрипт `common_scripts.py`

Этот скрипт содержит вспомогательные функции, которые используются в нескольких других скриптах. Он не предназначен для прямого запуска, но импортируется и используется другими скриптами.

#### Функции

- `download_image(url, path)`: Загружает изображения и сохраняет в указанную папку.
    - `url`: ссылка на изображение.
    - `path`: путь для сохранения изображения.
- `get_extension(url)`: Извлекает и возвращает расширение файла из заданного URL изображения.
  - `url`: URL изображения.
  - `get_date_from_epic(date)`: меняет формат даты на год/месяц/день/

### Как использовать

Функции этого скрипта можно импортировать в другие скрипты и использовать по мере необходимости. Например, чтобы импортировать и использовать функцию `download_image`, вы можете добавить следующую строку в начало другого скрипта:

`from common_scripts import download_image`

Поскольку `common_scripts.py` является набором вспомогательных функций, не предусмотрены аргументы командной строки или конкретные инструкции для запуска его напрямую.


## Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).